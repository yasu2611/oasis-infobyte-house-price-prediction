# -*- coding: utf-8 -*-
"""House Price Prediction (Level 2).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/197PdrK0QX56Ms3ngTm7cGab9GWEHR755
"""

import pandas as pd

df = pd.read_csv('/content/drive/MyDrive/dataset/Housing.csv')
df.head()

import pandas as pd

df = pd.read_csv('/content/drive/MyDrive/dataset/Housing.csv')

# Check missing values
missing = df.isnull().sum()

# Convert yes/no to 1/0
binary_cols = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_cols:
    df[col] = df[col].map({'yes':1, 'no':0})

# Convert furnishingstatus to dummies
df = pd.get_dummies(df, columns=['furnishingstatus'], drop_first=True)

df.head(), missing

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

# Load cleaned dataset
df = pd.read_csv('/content/drive/MyDrive/dataset/Housing.csv')

# Convert yes/no to 1/0 again for consistency
binary_cols = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_cols:
    df[col] = df[col].map({'yes':1, 'no':0})

# Furnishing dummies
df = pd.get_dummies(df, columns=['furnishingstatus'], drop_first=True)

# Split features/target
X = df.drop('price', axis=1)
y = df['price']

# Scale the data
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

X_scaled[:5]

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error

# Load raw dataset
df = pd.read_csv('/content/drive/MyDrive/dataset/Housing.csv')

# Convert yes/no to 1/0
binary_cols = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_cols:
    df[col] = df[col].map({'yes':1, 'no':0})

# One-hot encoding for furnishingstatus
df = pd.get_dummies(df, columns=['furnishingstatus'], drop_first=True)

# Feature/Target split
X = df.drop("price", axis=1)
y = df["price"]

# Scale features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Train-test split
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42
)

# Train model
model = LinearRegression()
model.fit(X_train, y_train)

# Predictions
y_pred = model.predict(X_test)

# Evaluation metrics
r2 = r2_score(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)

r2, mse

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

# Load and clean dataset
df = pd.read_csv('/content/drive/MyDrive/dataset/Housing.csv')
binary_cols = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_cols:
    df[col] = df[col].map({'yes':1, 'no':0})
df = pd.get_dummies(df, columns=['furnishingstatus'], drop_first=True)

X = df.drop("price", axis=1)
y = df["price"]

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42
)

model = LinearRegression()
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

# Chart 1: Actual vs Predicted Prices
plt.figure(figsize=(8,6))
plt.scatter(y_test, y_pred)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual vs Predicted House Prices")
plt.show()

# Chart 2: Residual Plot
residuals = y_test - y_pred
plt.figure(figsize=(8,6))
plt.scatter(y_pred, residuals)
plt.axhline(0)
plt.xlabel("Predicted Prices")
plt.ylabel("Residuals")
plt.title("Residual Plot")
plt.show()

import nbformat as nbf

nb = nbf.v4.new_notebook()
cells = []

cells.append(nbf.v4.new_markdown_cell("# House Price Prediction â€“ Final Project Notebook"))
cells.append(nbf.v4.new_markdown_cell("## Step 1: Import Libraries & Load Data"))
cells.append(nbf.v4.new_code_cell("""
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error

df = pd.read_csv('/Housing.csv') # Changed path for CSV
df.head()
"""))

cells.append(nbf.v4.new_markdown_cell("## Step 2: Data Cleaning"))
cells.append(nbf.v4.new_code_cell("""
binary_cols = ['mainroad','guestroom','basement','hotwaterheating','airconditioning','prefarea']
for col in binary_cols:
    df[col] = df[col].map({'yes':1, 'no':0})

df = pd.get_dummies(df, columns=['furnishingstatus'], drop_first=True)
df.head()
"""))

cells.append(nbf.v4.new_markdown_cell("## Step 3: Feature Scaling"))
cells.append(nbf.v4.new_code_cell("""
X = df.drop("price", axis=1)
y = df["price"]

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

X_scaled[:5]
"""))

cells.append(nbf.v4.new_markdown_cell("## Step 4: Train-Test Split & Model Training"))
cells.append(nbf.v4.new_code_cell("""
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42
)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

r2 = r2_score(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)

r2, mse
"""))

cells.append(nbf.v4.new_markdown_cell("## Step 5: Visualizations"))
cells.append(nbf.v4.new_code_cell("""
plt.figure(figsize=(8,6))
plt.scatter(y_test, y_pred)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual vs Predicted House Prices")
plt.show()

residuals = y_test - y_pred
plt.figure(figsize=(8,6))
plt.scatter(y_pred, residuals)
plt.axhline(0)
plt.xlabel("Predicted Prices")
plt.ylabel("Residuals")
plt.title("Residual Plot")
plt.show()
"""))

nb['cells'] = cells

path = "House_Price_Prediction_Final_Notebook.ipynb"
with open(path, "w") as f:
    nbf.write(nb, f)

path